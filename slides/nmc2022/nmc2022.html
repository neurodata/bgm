
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Bisected graph matching &#8212; Bisected Graph Matching</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <link rel="shortcut icon" href="../../_static/nd_logo_small.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/nd_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Bisected Graph Matching</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../abstract.html">
                    Abstract
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Preliminaries
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../explain.html">
   Explain GM vs. BGM
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Experiments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations.html">
   Simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../connectomes.html">
   Connectome data
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data wrangling
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../process_c_elegans.html">
   <em>
    C. elegans
   </em>
   connectomes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../process_maggot.html">
   Maggot connectome subset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../process_p_pacificus.html">
   <em>
    P. pacificus
   </em>
   pharynx connectomes
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Slides
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://docs.neurodata.io/bgm/cambridge.pdf">
   Cambridge
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://docs.neurodata.io/bgm/talk.pdf">
   Talk
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/neurodata/bgm"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/neurodata/bgm/issues/new?title=Issue%20on%20page%20%2Fslides/nmc2022/nmc2022.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/slides/nmc2022/nmc2022.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Bisected graph matching
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#benjamin-d-pedigo-johns-hopkins-university">
     Benjamin D. Pedigo - Johns Hopkins University
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#graph-matching-gm-for-connectomics">
   Graph matching (GM) for connectomics
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bisected-graph-matching-bgm">
   Bisected graph matching (BGM)
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bgm-increases-matching-accuracy">
   BGM increases matching accuracy
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extensions-to-bgm-multiplex-networks">
   Extensions to BGM: multiplex networks
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#acknowledgements">
     Acknowledgements
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Bisected graph matching</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Bisected graph matching
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#benjamin-d-pedigo-johns-hopkins-university">
     Benjamin D. Pedigo - Johns Hopkins University
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#graph-matching-gm-for-connectomics">
   Graph matching (GM) for connectomics
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bisected-graph-matching-bgm">
   Bisected graph matching (BGM)
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bgm-increases-matching-accuracy">
   BGM increases matching accuracy
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extensions-to-bgm-multiplex-networks">
   Extensions to BGM: multiplex networks
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#acknowledgements">
     Acknowledgements
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <!-- Hello, my name is Ben Pedigo, and I’m excited to tell you about my work on bisected graph matching and how it can be useful in connectomics.  -->
<!-- footer: __Paper:__ tinyurl.com/neuromatch-bgm -->
<!-- _paginate: false -->
<style scoped>
h1, h2 {
  color: white;
}
h1 {
    font-size: 70px
}
</style>
<p><img alt="bg" src="../../_images/nmc-background.svg" /></p>
<br>
<br>
<br>
<section class="tex2jax_ignore mathjax_ignore" id="bisected-graph-matching">
<h1>Bisected graph matching<a class="headerlink" href="#bisected-graph-matching" title="Permalink to this headline">#</a></h1>
<br>
<section id="benjamin-d-pedigo-johns-hopkins-university">
<h2>Benjamin D. Pedigo - Johns Hopkins University<a class="headerlink" href="#benjamin-d-pedigo-johns-hopkins-university" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<!-- So, why are we talking about graph matching in the first place, and what is it?

The motivation for this work is what you see on the left, which shows a bilaterally homologous neuron pair in the Drosophila larva. In Drosophila, C. elegans, and many other small organisms which are studied in connectomics, neurons often have a bilaterally homologous pair on the other side of the nervous system. These neurons are thought to be similar in terms of morphology, gene expression, and most importantly for this work, connectivity. 

Mapping the connectome of one of these organisms gives us a network of neurons, represented here as an adjacency matrix. I've sorted this adjacency matrix for an imaginary connectome by what side of the brain each neuron is in. Given one of these networks, several recent works showed that we can use graph matching to predict these neuron pairings from the basis of connectivity. Graph matching tries to make the adjacency matrix of the left-to-left hemisphere connections as similar as possible to that of the right-to-right hemisphere connections. It does so by optimizing over the set of matchings of these two subnetworks, here represented by P, which is a permutation of the nodes of one hemisphere with respect to the other.
 -->
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="graph-matching-gm-for-connectomics">
<h1>Graph matching (GM) for connectomics<a class="headerlink" href="#graph-matching-gm-for-connectomics" title="Permalink to this headline">#</a></h1>
<div class="columns2-br">
<div>
<p><img alt="center cropright h:400 w:290" src="../../_images/mbon-expression.jpg" /></p>
<p>Example bilateral neuron pair <em>Eschbach et al. 2021</em></p>
</div>
<div>
<p><img alt="center cropright w:630 h:400" src="../../_images/explain.svg" /></p>
</div>
</div>
<hr class="docutils" />
<!-- Now, notice that this approach of using graph matching ignores the connectivity which goes between the hemispheres, for instance this subgraph of connections from the left hemisphere to the right hemisphere. 

In this work, we asked a very simple question - would including these connections in our optimization improve matching performance? To get at this question, we created what we call the bisected graph matching problem. We added a term to the graph matching objective function which tries to make the contralateral subgraphs look as similar as possible under some matching. Further, we adapted a state-of-the-art graph matching algorithm called FAQ to solve this modified problem. 
-->
</section>
<section class="tex2jax_ignore mathjax_ignore" id="bisected-graph-matching-bgm">
<h1>Bisected graph matching (BGM)<a class="headerlink" href="#bisected-graph-matching-bgm" title="Permalink to this headline">#</a></h1>
<p><img alt="" src="../../_images/explain.svg" /></p>
<p><strong>We adapt the FAQ algorithm (Vogelstein et al. 2015) to solve BGM</strong></p>
<hr class="docutils" />
<!-- To test our approach, we evaluated graph matching and bisected graph matching on 5 published connectome datasets for which these bilateral pairings were already known. We found that on all 5 of the connectome datasets we examined, this bisected graph matching procedure significantly improved matching accuracy, and buy a surprisingly large amount.  -->
</section>
<section class="tex2jax_ignore mathjax_ignore" id="bgm-increases-matching-accuracy">
<h1>BGM increases matching accuracy<a class="headerlink" href="#bgm-increases-matching-accuracy" title="Permalink to this headline">#</a></h1>
<p><img alt="center h:550" src="../../_images/match_accuracy_comparison.svg" /></p>
<hr class="docutils" />
<!-- BGM can also be combined with other extensions of graph matching. Here, we combine our approach with multiplex graph matching. Multiplex graph matching allows us to incorporate multiple types of connections in the optimization - here, both chemical and electrical synapses in the C. elegans. We found that using bisected and multiplex graph matching improved matching accuracy more than using either technique alone on two c. elegans connectomes. Our paper describes how to combine BGM with several other graph matching extensions which can further improve performance.  -->
</section>
<section class="tex2jax_ignore mathjax_ignore" id="extensions-to-bgm-multiplex-networks">
<h1>Extensions to BGM: multiplex networks<a class="headerlink" href="#extensions-to-bgm-multiplex-networks" title="Permalink to this headline">#</a></h1>
<p><img alt="center h:500" src="../results/figs/connectome_multilayer/accuracy_upsetplot.svg" /></p>
<hr class="docutils" />
<!-- To summarize, graph matching is a useful way of pairing neurons between connectome datasets; in particular, between the two sides of a nervous system. 

When doing this matching between hemispheres, we present a method for including the entire connectome in the optimization, which we find greatly improves performance in practice. 

There’s a link to the manuscript on bioarxiv, as well all code for this manuscript. We also include an implementation of graph matching and bisected graph matching in our open source python package, graspologic. Please feel free to get in touch if you have any questions.
 -->
<p><img alt="bg center blur:3px opacity:15%" src="../../_images/background.svg" /></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p>Matching approaches can help find paired neurons between connectomes</p></li>
<li><p>BGM uses more of the data to improve matching between hemispheres</p></li>
<li><p>Manuscript on bioRxiv: <a class="reference external" href="http://tinyurl.com/neuromatch-bgm">tinyurl.com/neuromatch-bgm</a></p></li>
<li><p>Code for all experiments: <a class="reference external" href="http://github.com/neurodata/bgm">github.com/neurodata/bgm</a></p></li>
<li><p>Matching algorithm: <a class="reference external" href="http://github.com/microsoft/graspologic">github.com/microsoft/graspologic</a></p></li>
<li><p>Contact: <a class="reference external" href="mailto:bpedigo&#37;&#52;&#48;jhu&#46;edu">bpedigo<span>&#64;</span>jhu<span>&#46;</span>edu</a></p></li>
</ul>
<section id="acknowledgements">
<h2>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Co-authors: Michael Winding, Carey E. Priebe, Joshua T. Vogelstein</p></li>
<li><p>Funding: NSF GRFP, NSF Career, NIH BRAIN Initiative, Microsoft Research</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./slides/nmc2022"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Benjamin D. Pedigo<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>